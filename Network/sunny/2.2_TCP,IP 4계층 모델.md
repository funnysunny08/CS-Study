# TCP/IP 4계층 모델

## TCP/IP 란?

### 패킷 통신이란?

> 데이터를 패킷이라고 하는 작은 단위로 나누어 전송하는 방식
> 

### IP (Internet Protocol) 란?

> IP는 패킷 데이터들을 최대한 빨리 특정 목적지 주소로 보내는 프로토콜
> 
- 패킷 전달 여부를 보증하지 않으며, 패킷을 보낸 순서와 받는 순서가 다를 수 있다❗️

### TCP (Transmission Control Protocol) 란?

> TCP는 패킷을 ***정상적으로*** 받을 수 있도록 하는 프로토콜
> 
- 패킷 전달 여부를 보증하고, 패킷을 송신 순서대로 받게 해준다❗️
- 즉, 목적지에 도착한 패킷들을 순서대로 정렬하고, 손상되거나 손실된 패킷이 있다면 출발지에 재요청하는 방식

### TCP/IP 란?

> TCP/IP는 IP (인터넷 프로토콜)와 TCP (전송 조절 프로토콜)의 묶음을 의미
> 

***즉, 두 가지 프로토콜 방식을 조합하여 인터넷 통신을 하는 것을 TCP/IP라고 부른다.***

💡 송신자가 수신자에게 IP를 사용하여 최대한 빠르게 패킷을 전송하면 TCP를 활용해 패킷을 정상적으로 수신 받는다

## 계층 구조

*TCP/IP 계층은 네 개의 계층을 가지고 있으며 OSI 계층과 많이 비교한다*

![https://user-images.githubusercontent.com/88873302/228820572-fe26ac69-12a7-41f1-a663-32f6ded34dfa.png](https://user-images.githubusercontent.com/88873302/228820572-fe26ac69-12a7-41f1-a663-32f6ded34dfa.png)

- OSI 7계층은 컴퓨터 간 패킷 통신을 위해 거쳐야하는 7계층을 의미한다
- TCP/IP 4계층은 TCP/IP 프로토콜 통신 과정에 초점을 맞추어, OSI 7계층을 좀 더 단순화 시킨 계층을 의미한다
- 이러한 계층적인 구조의 특징은 아래와 같다
    - 각 계층별 처리 역할이 다르기 때문에 계층별 간섭을 최소화할 수 있다
    - 특정 계층에서 문제가 생기면 해당 계층을 살펴보면 되기 때문에 유지보수가 편리하다
    - 다른 계층끼리는 데이터의 전달 과정을 구체적으로 알 필요가 없기 때문에 데이터의 캡슐화와 은닉이 가능하다

### 4계층 : 애플리케이션 계층 (Application Layer)

- 웹 서비스, 이메일 등 ***서비스를 실질적으로 사람들에게 제공하는 층***
- 사용자 - 소프트웨어 간 소통을 담당
- FTP, HTTP, SSH, SMTP, DNS 등의 프로토콜이 존재
    - FTP : 장치와 장치 간의 파일을 전송하는 데 사용되는 표준 통신 프로토콜
    - SSH : 보안되지 않은 네트워크에서 네트워크 서비스를 안전하게 운영하기 위한 암호화 네트워크 프로토콜
    - HTTP : World Wide Web을 위한 데이터 통신의 기초이자 웹 사이트를 이용하는 데 쓰는 프로토콜
    - SMTP : 전자 메일 전송을 위한 인터넷 표준 통신 프로토콜
    - DNS : 도메인 이름과 IP 주소를 매핑해주는 서버

### 3계층 : 전송 계층 (Transport Layer)

- ***통신 노드 간 신뢰성 있는 데이터 전송을 보장하는 계층***
- 연결 지향 데이터 스트림 지원, 신뢰성, 흐름 제어를 제공할 수 있다
- ***애플리케이션 계층과 인터넷 계층 사이의 데이터가 전달될 때 중계 역할***
- TCP, UDP
    - TCP는 패킷 사이의 순서를 보장하고 연결지향 프로토콜을 사용해서 연결을 하여 신뢰성을 구축해서 수신 여부를 확인하며 ‘[가상회선 패킷 교환 방식](https://www.notion.so/TCP-IP-4-897991f47029488094c6d08a8676cdec)’을 사용한다.
    - UDP는 순서를 보장하지 않고 수신 여부를 확인하지 않으며 단순히 데이터만 주는 ‘[데이터그램 패킷 교환 방식](https://www.notion.so/TCP-IP-4-897991f47029488094c6d08a8676cdec)’을 사용한다.

### 2계층 : 인터넷 계층 (Internet Layer)

- 장치로부터 받은 네트워크 패킷을 IP 주소로 지정된 목적지로 전송하기 위해 사용되는 계층
- 패킷을 수신해야 할 상대의 주소를 지정하여 데이터를 전달
- 상대방이 제대로 받았는지에 대해 보장하지 않는 **비연결형적인 특성**
- IP, ARP, ICMP

### 1계층 : 링크 계층 (Link Layer)

- 링크 계층은 전선, 광섬유, 무선 등으로 ***실질적으로 데이터를 전달하며 장치 간에 신호를 주고받는 ‘규칙’을 정하는 계층***
- 이를 물리 계층과 데이터 링크 계층으로 나누기도 하는데
    - 물리 계층은 [무선 LAN](https://www.notion.so/TCP-IP-4-897991f47029488094c6d08a8676cdec)과 [유선 LAN](https://www.notion.so/TCP-IP-4-897991f47029488094c6d08a8676cdec)을 통해 0과 1로 이루어진 데이터를 보내느 계층
    - 데이터 링크 계층은 ‘[이더넷 프레임](https://www.notion.so/TCP-IP-4-897991f47029488094c6d08a8676cdec)’을 통해 에러 확인, 흐름 제어, 접근 제어를 담당하는 계층

## 계층 간 데이터 송수신 과정

💡 컴퓨터를 통해 다른 컴퓨터로 데이터를 요청한다면 어떠한 일이 일어날까?

![https://user-images.githubusercontent.com/88873302/229553950-112fcada-adc7-40e1-8c11-575f6709d391.png](https://user-images.githubusercontent.com/88873302/229553950-112fcada-adc7-40e1-8c11-575f6709d391.png)

> 애플리케이션 계층에서 전송 계층으로 보내는 요청(request) 값들이 캡슐화 과정을 거쳐 전달되고, 다시 링크 계층을 통해 해당 서버와 통신을 하고, 해당 서버의 링크 계층으로부터 애플리케이션까지 비캡슐화 과정을 거쳐 데이터가 전송된다
> 

### 캡슐화 과정

![https://user-images.githubusercontent.com/88873302/229657850-91938557-c53e-4806-b16a-a0a8dbaa9b41.png](https://user-images.githubusercontent.com/88873302/229657850-91938557-c53e-4806-b16a-a0a8dbaa9b41.png)

> 캡슐화 과정은 상위 계층의 헤더와 데이터를 하위 계층의 데이터 부분에 포함시키고 해당 계층의 헤더를 삽입하는 과정
> 
- 애플리케이션 계층의 데이터가 전송 계층으로 전달되면서 ‘세그먼트’ 또는 데이터그램’화 되며 TCP(L4) 헤더가 붙여지게 된다.
- 이후 인터넷 계층으로 가면서 IP(L3) 헤더가 붙여지게 되며 ‘패킷화’가 되고
- 이후 링크 계층으로 전달되면서 프레임 헤더와 프레임 트레일러가 붙어 ‘프레임’화가 된다

### 비캡슐화 과정

![https://user-images.githubusercontent.com/88873302/229657886-67ec834d-43f4-44be-b19a-270c7eddbd68.png](https://user-images.githubusercontent.com/88873302/229657886-67ec834d-43f4-44be-b19a-270c7eddbd68.png)

> 비캡슐화 과정은 하위 계층에서 상위 계층으로 가며 각 계층의 헤더 부분을 제거하는 과정
> 
- 캡슐화된 데이터를 받게 되면 링크 계층에서부터 타고 올라오면서 프레임화된 데이터는 다시 패킷화를 거쳐 세그먼트, 데이터그램화를 거쳐 메시지화가 되는 비캡슐화 과정이 일어난다
- 그 이후 최종적으로 사용자에게 애플리케이션의 PDU인 메시지로 전달된다

## PDU (Protocol Data Unit)

> 네트워크의 어떠한 계층에서 계층으로 데이터가 전달될 때 한 덩어리의 단위를 PDU라고 한다
> 

PDU는 제어 관련 정보들이 포함된 ‘헤더’, 데이터를 의미하는 ‘페이로드’로 구성되어 있으며 계층마다 부르는 명칭이 다르다

- 애플리케이션 계층 : 메시지
- 전송 계층 : 세그먼트 (TCP), 데이터그램 (UDP)
- 인터넷 계층 : 패킷
- 링크 계층 : 프레임 (데이터 링크 계층), 비트 (물리 계층)

✋ 참고로 PDU 중 아래 계층인 비트로 송수신하는 것이 모든 PDU 중 가장 빠르고 효율성이 높다. 하지만 애플리케이션 계층에서는 문자열을 기반으로 송수신을 하는데, 그 이유는 헤더 authorization 값 등 다른 값을을 넣는 확장이 쉽기 때문이다.

---

- **💡 추가 개념 정리**
    
    ### 가상 회선 패킷 교환 방식
    
    ### 데이터그램 패킷 교환 방식
    
    ### TCP 연결 성립 과정
    
    ### TCP 연결 해제 과정
    
    ### 유선 LAN(IEEE802.3)
    
    ### 유선 LAN을 이루는 케이블
    
    ### 무선 LAN(IEEE802.11)
    
    ### 무선 LAN을 이루는 주파수
    
    ### 이더넷 프레임
    

---

### 참고 자료

- 면접을 위한 CS 전공지식 노트
- [https://wooono.tistory.com/507](https://wooono.tistory.com/507)